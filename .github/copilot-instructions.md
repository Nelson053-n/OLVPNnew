# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ Copilot –¥–ª—è –ë–æ—Ç–∞ Outline VPN

## –û–±–∑–æ—Ä –ø—Ä–æ–µ–∫—Ç–∞
–≠—Ç–æ **Telegram-–±–æ—Ç** –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∫–ª—é—á–µ–π –¥–æ—Å—Ç—É–ø–∞ Outline VPN. –ë–æ—Ç –∏–Ω—Ç–µ–≥—Ä–∏—Ä—É–µ—Ç—Å—è —Å:
- **Telegram API** (aiogram 3+) –¥–ª—è –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
- **Outline VPN** (–∫–∞—Å—Ç–æ–º–Ω—ã–π –º–æ–¥—É–ª—å –≤ `outline_vpn/`) –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–ª—é—á–∞–º–∏ –¥–æ—Å—Ç—É–ø–∞
- **YooKassa** –ø–ª–∞—Ç–µ–∂–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–ª–∞—Ç–µ–∂–µ–π
- **SQLite + SQLAlchemy 2+** –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –ø–ª–∞—Ç–µ–∂–µ–π
- **Jinja2 —à–∞–±–ª–æ–Ω—ã** –≤ `core/templates/` –¥–ª—è –∫–∞—Å—Ç–æ–º–∏–∑–∏—Ä—É–µ–º—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏ –ø–æ—Ç–æ–∫ –¥–∞–Ω–Ω—ã—Ö

### –ú–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
–ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç **–¥–≤–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–∞** —á–µ—Ä–µ–∑ multiprocessing –≤ `main.py`:
1. **–ü—Ä–æ—Ü–µ—Å—Å –±–æ—Ç–∞** (`run_bot()`) - –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º Telegram
2. **–ü—Ä–æ—Ü–µ—Å—Å –ø—Ä–æ–≤–µ—Ä–∫–∏** (`run_checker()`) - –ó–∞–ø—É—Å–∫–∞–µ—Ç `check_time_subscribe.py` –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∏—Å—Ç–µ—á–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–æ–∫

–û–±–∞ –ø—Ä–æ—Ü–µ—Å—Å–∞ —Ä–∞–±–æ—Ç–∞—é—Ç —Å –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–º–∏ async event loop'–∞–º–∏.

### –û—Å–Ω–æ–≤–Ω–æ–π –ø–æ—Ç–æ–∫: –ü–ª–∞—Ç—ë–∂ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ‚Üí –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–∞
1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–∑—ã–≤–∞–µ—Ç `/start` ‚Üí `core/handlers/start.py` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ë–î –∏ Outline –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–ª—é—á–µ–π
2. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–¥–µ–Ω—å/–Ω–µ–¥–µ–ª—è/–º–µ—Å—è—Ü) —á–µ—Ä–µ–∑ inline-–∫–Ω–æ–ø–∫–∏
3. –ü–ª–∞—Ç—ë–∂ —Å–æ–∑–¥–∞—ë—Ç—Å—è —á–µ—Ä–µ–∑ `core/api_s/api_youkassa/youkassa_api.py`
4. –ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –ø–ª–∞—Ç–µ–∂–∞ `OutlineManager` –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –Ω–æ–≤—ã–π –∫–ª—é—á –≤ `core/api_s/outline/outline_api.py`
5. –ö–ª—é—á —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ —Ç–∞–±–ª–∏—Ü–µ `Users` —Å –¥–∞—Ç–æ–π –∏—Å—Ç–µ—á–µ–Ω–∏—è
6. –§–æ–Ω–æ–≤—ã–π –ø—Ä–æ—Ü–µ—Å—Å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫–∏ –≤—ã–∑—ã–≤–∞–µ—Ç `check_time_subscribe()` –¥–ª—è –æ—Ç–∑—ã–≤–∞ –∏—Å—Ç–µ–∫—à–∏—Ö –∫–ª—é—á–µ–π

### –°—Ö–µ–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö (SQLite)
- **–¢–∞–±–ª–∏—Ü–∞ Users** (`core/sql/base.py`):
  - `account` (int, unique) - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Telegram
  - `key` (str) - URL –¥–æ—Å—Ç—É–ø–∞ Outline
  - `date` (DateTime) - –î–∞—Ç–∞ –∏—Å—Ç–µ—á–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏
  - `premium` (bool) - –°—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
  - `region_server` (str) - –í—ã–±—Ä–∞–Ω–Ω—ã–π —Ä–µ–≥–∏–æ–Ω —Å–µ—Ä–≤–µ—Ä–∞
  - `promo_key` (bool) - –§–ª–∞–≥ –±–µ—Å–ø–ª–∞—Ç–Ω–æ–≥–æ –ø—Ä–æ–±–Ω–æ–≥–æ –ø–µ—Ä–∏–æ–¥–∞
- **–¢–∞–±–ª–∏—Ü–∞ UserPay** - –ó–∞–ø–∏—Å–∏ –æ –ø–ª–∞—Ç–µ–∂–∞—Ö —Å –≤–Ω–µ—à–Ω–∏–º –∫–ª—é—á–æ–º –Ω–∞ Users

## –ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã –∏ –ø–∞—Ç—Ç–µ—Ä–Ω—ã

### –ü–∞—Ç—Ç–µ—Ä–Ω –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ (`core/handlers/`)
- **Callback-–º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è**: `build_and_edit_message()` –≤ `handler_keyboard.py` –º–∞—Ä—à—Ä—É—Ç–∏–∑–∏—Ä—É–µ—Ç –≤—Å–µ –Ω–∞–∂–∞—Ç–∏—è inline-–∫–Ω–æ–ø–æ–∫ —á–µ—Ä–µ–∑ `switch_dict`
- **FSMContext** –ø–µ—Ä–µ–¥–∞—ë—Ç—Å—è –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º, –Ω–æ —Ä–µ–¥–∫–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è (–ø—Ä–æ—Å—Ç–æ–π –∑–∞–ø—Ä–æ—Å-–æ—Ç–≤–µ—Ç)
- –û—Ç–¥–µ–ª—å–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –≤ `handlers_keyboards/` (–Ω–∞–ø—Ä–∏–º–µ—Ä `get_key_handler.py`) –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –∫–æ—Ä—Ç–µ–∂–∏ `(text, reply_markup)`
- **–ü—Ä–∏–º–µ—Ä**: –ö–Ω–æ–ø–∫–∏ –î–µ–Ω—å/–ù–µ–¥–µ–ª—è/–ú–µ—Å—è—Ü ‚Üí —Å–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞ ‚Üí –ø–æ–∫–∞–∑ —Å—Å—ã–ª–∫–∏ –Ω–∞ –æ–ø–ª–∞—Ç—É

### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —à–∞–±–ª–æ–Ω–æ–≤ (Jinja2)
- –®–∞–±–ª–æ–Ω—ã –≤ `core/templates/` (HTML-—Ñ–∞–π–ª—ã) —Ä–µ–Ω–¥–µ—Ä—è—Ç—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏
- `create_answer_from_html()` –≤ `core/utils/create_view.py` –∑–∞–≥—Ä—É–∂–∞–µ—Ç –∏ —Ä–µ–Ω–¥–µ—Ä–∏—Ç —à–∞–±–ª–æ–Ω—ã
- –®–∞–±–ª–æ–Ω—ã –ø–æ–∑–≤–æ–ª—è—é—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å –æ—Ç–≤–µ—Ç—ã –±–µ–∑ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∏ –±–æ—Ç–∞

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è Outline (`core/api_s/outline/`)
- –ö–ª–∞—Å—Å `OutlineManager` –æ–±—ë—Ä—Ç—ã–≤–∞–µ—Ç –∫–∞—Å—Ç–æ–º–Ω—ã–π –º–æ–¥—É–ª—å `outline_vpn.OutlineVPN`
- **–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Ä–µ–≥–∏–æ–Ω–æ–≤**: `settings_api_outline.json` —Ö—Ä–∞–Ω–∏—Ç API URL'—ã –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã –¥–ª—è –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤
- –ú–µ—Ç–æ–¥—ã: `get_key_from_ol()`, `create_key_in_ol()`, `delete_key_from_ol()`
- –§–æ—Ä–º–∞—Ç –∫–ª—é—á–∞: —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ URL –¥–æ—Å—Ç—É–ø–∞ —Å –≤—Å—Ç—Ä–æ–µ–Ω–Ω–æ–π –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–µ–π

### –û–ø–µ—Ä–∞—Ü–∏–∏ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö (`core/sql/`)
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç **SQLAlchemy ORM** —Å —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–º–∏ —Å–µ—Å—Å–∏—è–º–∏
- –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –ë–î –ø–æ–º–µ—á–µ–Ω—ã –∫–∞–∫ `async def` –Ω–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç **–±–ª–æ–∫–∏—Ä—É—é—â–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –∫–æ–¥** (–≤—ã–∑–æ–≤—ã Session())
  - –≠—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –Ω–∞–º–µ—Ä–µ–Ω–Ω–æ, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å —É–ª—É—á—à–µ–Ω–æ —Å –ø–æ–º–æ—â—å—é `asyncpg` + SQLAlchemy async
- –§—É–Ω–∫—Ü–∏–∏ –Ω–∞–∑—ã–≤–∞—é—Ç—Å—è —Å –ø—Ä–µ—Ñ–∏–∫—Å–æ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞: `get_user_data_from_table_users()`, `set_key_to_table_users()`

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –ø–ª–∞—Ç–µ–∂–µ–π (`core/api_s/api_youkassa/`)
- `create_payment()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç URL –¥–ª—è –æ–ø–ª–∞—Ç—ã
- `check_payment()` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Å—Ç–∞—Ç—É—Å –ø–ª–∞—Ç–µ–∂–∞ –≤ YooKassa
- `get_user_payments()` –∏—â–µ—Ç –∏—Å—Ç–æ—Ä–∏—á–µ—Å–∫–∏–µ –ø–ª–∞—Ç–µ–∂–∏ –ø–æ ID Telegram (–≤—Å—Ç—Ä–æ–µ–Ω –≤ –æ–ø–∏—Å–∞–Ω–∏–µ)

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∏ —Å–µ–∫—Ä–µ—Ç—ã

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env`)
- `API_KEY_TLG` - –¢–æ–∫–µ–Ω Telegram-–±–æ—Ç–∞
- `ADMIN_TLG` - ID –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
- `YOUKASSA_ID` - ID —Ç–æ—Ä–≥–æ–≤—Ü–∞ YooKassa
- `YOUKASSA_SECRET` - –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á YooKassa
- –ó–∞–≥—Ä—É–∂–∞—é—Ç—Å—è —á–µ—Ä–µ–∑ `python-dotenv` –≤ `core/settings.py`
- –ï—Å–ª–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç, –±–æ—Ç –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç –≤–≤–æ–¥ –∏ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç –≤ `.env` (—É–¥–æ–±–Ω–æ, –Ω–æ –Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –≤ production)

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Å–µ—Ä–≤–µ—Ä–∞ Outline (`core/api_s/outline/settings_api_outline.json`)
```json
{
  "nederland": {
    "api_url": "https://...",
    "cert_sha256": "...",
    "is_active": true,
    "name_en": "Nederland"
  }
}
```

## –û–±—â–∏–µ –∑–∞–¥–∞—á–∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–π –∫–Ω–æ–ø–∫–∏/–æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞
1. –°–æ–∑–¥–∞–π—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞ –≤ `core/handlers/handlers_keyboards/` –≤–æ–∑–≤—Ä–∞—â–∞—é—â—É—é `(str, InlineKeyboardMarkup)`
2. –î–æ–±–∞–≤—å—Ç–µ case –≤ `switch_dict` –≤ `handler_keyboard.py`
3. –°–æ–∑–¥–∞–π—Ç–µ –∫–Ω–æ–ø–∫—É –∫–ª–∞–≤–∏–∞—Ç—É—Ä—ã –≤ `core/keyboards/` —Å —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–º–∏ –¥–∞–Ω–Ω—ã–º–∏ callback'–∞

### –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ç–µ–∫—Å—Ç–∞ –æ—Ç–≤–µ—Ç–∞
1. –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä—É–π—Ç–µ —à–∞–±–ª–æ–Ω –≤ `core/templates/` (–ø–µ—Ä–µ–∑–∞–≥—Ä—É–∑–∫–∞ –±–æ—Ç–∞ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)
2. –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ —Å –∫–∞—Å—Ç–æ–º–Ω—ã–º —Ç–µ–∫—Å—Ç–æ–º

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–µ–≥–∏–æ–Ω–∞/—Å–µ—Ä–≤–µ—Ä–∞
1. –î–æ–±–∞–≤—å—Ç–µ –∑–∞–ø–∏—Å—å –≤ `settings_api_outline.json` —Å —É—á—ë—Ç–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ API
2. –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –æ–±–Ω–æ–≤–∏—Ç–µ –ª–æ–≥–∏–∫—É –≤ `get_name_all_active_server_ol()`
3. –†–µ–≥–∏–æ–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ—è–≤–∏—Ç—Å—è –≤ –º–µ–Ω—é –≤—ã–±–æ—Ä–∞ —Ä–µ–≥–∏–æ–Ω–∞

### –û—Ç–ª–∞–¥–∫–∞ –ø—Ä–æ–±–ª–µ–º —Å –ø–ª–∞—Ç–µ–∂–∞–º–∏
1. –ö–æ–º–∞–Ω–¥–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ `/findpay <user_id>` –∏—â–µ—Ç –ø–ª–∞—Ç–µ–∂–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ YooKassa
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç–∞—Ç—É—Å –≤—Ä—É—á–Ω—É—é –≤ –ø–∞–Ω–µ–ª–∏ YooKassa
3. –ü—Ä–∏–º–µ—á–∞–Ω–∏–µ: –ü–æ–∏—Å–∫ –ø–ª–∞—Ç–µ–∂–µ–π –∑–∞–≤–∏—Å–∏—Ç –æ—Ç ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –æ–ø–∏—Å–∞–Ω–∏–∏ –ø–ª–∞—Ç–µ–∂–∞

### –ü—Ä–æ—Å–º–æ—Ç—Ä –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–ª—é—á–µ –∏ –µ–≥–æ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
1. –ö–æ–º–∞–Ω–¥–∞ `/keyinfo <user_id>` –≤—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –∫–ª—é—á–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:
   - Telegram –∏–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
   - –†–µ–≥–∏–æ–Ω –≤—ã–±—Ä–∞–Ω–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞
   - –¢—Ä–∞—Ñ–∏–∫ –∑–∞ 30 –¥–Ω–µ–π (–≤ –ì–ë)
   - –°—Ç–∞—Ç—É—Å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –∫–ª—é—á–∞
2. –ö–æ–º–∞–Ω–¥–∞ –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –∫–Ω–æ–ø–∫—É "üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å –∫–ª—é—á" –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞
3. –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É:
   - –ö–ª—é—á —É–¥–∞–ª—è–µ—Ç—Å—è –∏–∑ Outline VPN
   - –°—Ç–∞—Ç—É—Å premium –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è –Ω–∞ False
   - –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –æ–± –æ–∫–æ–Ω—á–∞–Ω–∏–∏ –ø–æ–¥–ø–∏—Å–∫–∏

### –ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
1. –ö–æ–º–∞–Ω–¥–∞ `/activekeys` –≤—ã–≤–æ–¥–∏—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —Å –∞–∫—Ç–∏–≤–Ω—ã–º–∏ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
2. –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –≤–∫–ª—é—á–∞–µ—Ç:
   - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ Telegram –∏–º—è
   - –†–µ–≥–∏–æ–Ω —Å–µ—Ä–≤–µ—Ä–∞
   - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –æ–∫–æ–Ω—á–∞–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏
   - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–Ω–µ–π –¥–æ –æ–∫–æ–Ω—á–∞–Ω–∏—è
3. –°–ø–∏—Å–æ–∫ –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω –ø–æ –¥–∞—Ç–µ –æ–∫–æ–Ω—á–∞–Ω–∏—è (–±–ª–∏–∂–∞–π—à–∏–µ —Å–Ω–∞—á–∞–ª–∞)
4. –í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã:
   - üî¥ –ö–ª—é—á –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –∑–∞–≤—Ç—Ä–∞ –∏–ª–∏ —Å–µ–≥–æ–¥–Ω—è
   - üü° –ö–ª—é—á –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è —á–µ—Ä–µ–∑ 2-3 –¥–Ω—è
   - üü¢ –ö–ª—é—á –µ—â—ë –¥–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω –±–æ–ª–µ–µ 3 –¥–Ω–µ–π
5. –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –±–æ–ª—å—à–µ 10, —Å–ø–∏—Å–æ–∫ –≤—ã–≤–æ–¥–∏—Ç—Å—è —á–∞—Å—Ç—è–º–∏

### –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö VPN-—Å–µ—Ä–≤–µ—Ä–æ–≤ (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä)
1. –ö–æ–º–∞–Ω–¥–∞ `/addserver` –∑–∞–ø—É—Å–∫–∞–µ—Ç –¥–∏–∞–ª–æ–≥–æ–≤—ã–π —Ä–µ–∂–∏–º –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–∞
2. –≠—Ç–∞–ø—ã –¥–∏–∞–ª–æ–≥–∞:
   - –£–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –Ω–∞–∑–≤–∞–Ω–∏–µ —Å—Ç—Ä–∞–Ω—ã ‚Üí —Ñ–ª–∞–≥ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
   - –í–≤–æ–¥–∏—Ç—Å—è API URL —Å–µ—Ä–≤–µ—Ä–∞ Outline (https://...)
   - –í–≤–æ–¥–∏—Ç—Å—è SHA256 —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç —Å–µ—Ä–≤–µ—Ä–∞
   - –ü—Ä–æ–≤–µ—Ä—è—é—Ç—Å—è –∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞—é—Ç—Å—è –¥–∞–Ω–Ω—ã–µ
3. –ü–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —Å–µ—Ä–≤–µ—Ä:
   - –ü–æ—è–≤–ª—è–µ—Ç—Å—è –≤ `settings_api_outline.json`
   - –°—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –¥–æ—Å—Ç—É–ø–Ω—ã–º –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ –≤—ã–±–æ—Ä–µ —Ä–µ–≥–∏–æ–Ω–∞
   - –ú–æ–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –ø–æ–∫—É–ø–∫–∏ –∫–ª—é—á–µ–π
4. –§–ª–∞–≥–∏ —Å—Ç—Ä–∞–Ω –æ–ø—Ä–µ–¥–µ–ª—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏–∑ —Å–ª–æ–≤–∞—Ä—è `COUNTRY_FLAGS` –≤ `core/utils/server_config.py`

## –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã –∏ –∞–Ω—Ç–∏-–ø–∞—Ç—Ç–µ—Ä–Ω—ã

### –ù–∞–º–µ—Ä–µ–Ω–Ω–æ–µ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–µ —Å –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π
–§—É–Ω–∫—Ü–∏–∏ –ë–î –∏—Å–ø–æ–ª—å–∑—É—é—Ç `async def` –Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–µ —Å–µ—Å—Å–∏–∏ SQLAlchemy. –≠—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –Ω–µ –¥–∞—ë—Ç –ø—Ä–µ–∏–º—É—â–µ—Å—Ç–≤ async. –†–∞—Å—Å–º–æ—Ç—Ä–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é –Ω–∞ `asyncpg`, –µ—Å–ª–∏ –ë–î —Å—Ç–∞–Ω–µ—Ç —É–∑–∫–∏–º –º–µ—Å—Ç–æ–º.

### –ü—É—Ç–∏ –∫ —à–∞–±–ª–æ–Ω–∞–º –∂—ë—Å—Ç–∫–æ –∑–∞–∫–æ–¥–∏—Ä–æ–≤–∞–Ω—ã
–®–∞–±–ª–æ–Ω—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –∏–∑ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏—Ö –ø—É—Ç–µ–π –≤—Ä–æ–¥–µ `core/templates/`. –ù–µ—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –¥–ª—è –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —à–∞–±–ª–æ–Ω–æ–≤.

### –í—ã–±–æ—Ä —Ä–µ–≥–∏–æ–Ω–∞ —á–µ—Ä–µ–∑ —Ü–∏–∫–ª
`start.py` –ø—Ä–æ—Ö–æ–¥–∏—Ç –ø–æ –≤—Å–µ–º —Ä–µ–≥–∏–æ–Ω–∞–º –≤ –ø–æ–∏—Å–∫–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –∫–ª—é—á–µ–π. –≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ —Å—Ç–∞—Ä—ã–º –∫–ª—é—á–æ–º –Ω–∞–π–¥—ë—Ç –µ–≥–æ –¥–∞–∂–µ –µ—Å–ª–∏ –¥–æ–±–∞–≤–ª–µ–Ω –≤ –¥—Ä—É–≥–æ–π —Ä–µ–≥–∏–æ–Ω.

### –ú–∏–Ω–∏–º—É–º –∞–¥–º–∏–Ω-–∫–æ–º–∞–Ω–¥
–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∫–æ–º–∞–Ω–¥—ã: `/start`, `/findpay`, `/get_log_pay`, `/get_db`, `/promo`, `/keyinfo`, `/activekeys`, `/addserver`. –ù–æ–≤—ã–µ –∞–¥–º–∏–Ω-—Ñ—É–Ω–∫—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞.

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏–µ

### –õ–æ–∫–∞–ª—å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
```bash
pip install -r requirements.txt
python main.py  # –ó–∞–ø—Ä–æ—Å–∏—Ç —Å–µ–∫—Ä–µ—Ç—ã –µ—Å–ª–∏ .env –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
```

### Production (–ø—Ä–∏–º–µ—Ä systemd –≤ README)
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç systemd-—Å–µ—Ä–≤–∏—Å —Å `ExecStart` —É–∫–∞–∑—ã–≤–∞—é—â–∏–º –Ω–∞ venv Python –∏ main.py. –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ .env –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ —Ä–∞–±–æ—á–µ–π –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏.

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
–î–≤–∞ –æ—Ç–¥–µ–ª—å–Ω—ã—Ö –ª–æ–≥–≥–µ—Ä–∞ —á–µ—Ä–µ–∑ `RotatingFileLogger`:
- –õ–æ–≥–∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–æ—Ç–∞ ‚Üí `logs/log_main.py` —Å –∫–æ–Ω—Ñ–∏–≥–æ–º `log_settings_base.json`
- –õ–æ–≥–∏ –ø–ª–∞—Ç–µ–∂–µ–π ‚Üí –æ—Ç–¥–µ–ª—å–Ω—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä —Å `log_settings_payments.json`

---

**–û–±–Ω–æ–≤–ª–µ–Ω–æ**: –î–µ–∫–∞–±—Ä—å 2025  
**–ö–ª—é—á–µ–≤–∞—è —Ç–æ—á–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–∞**: –ü—Ä–æ–≤–µ—Ä—å—Ç–µ `core/bot.py` –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Dispatcher –∏ `main.py` –¥–ª—è –º–Ω–æ–≥–æ–ø—Ä–æ—Ü–µ—Å—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã.
